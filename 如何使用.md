# Agent 平台使用指南

## 🎉 项目已完成并可运行！

所有核心功能已实现并通过测试。后端服务当前正在运行中。

## ✅ 当前状态

### 后端服务
- **状态**: ✅ 运行中
- **地址**: http://localhost:8080
- **进程**: 正常运行
- **日志**: 所有 API 路由已注册

### API 端点 (全部可用)
```
✅ GET    /health
✅ GET    /api/v1/ping
✅ POST   /api/v1/agents
✅ GET    /api/v1/agents
✅ GET    /api/v1/agents/:id
✅ PUT    /api/v1/agents/:id
✅ DELETE /api/v1/agents/:id
✅ POST   /api/v1/conversations
✅ GET    /api/v1/conversations
✅ GET    /api/v1/conversations/:id
✅ POST   /api/v1/conversations/:id/messages
✅ POST   /api/v1/tools
✅ GET    /api/v1/tools
✅ GET    /api/v1/tools/:id
✅ DELETE /api/v1/tools/:id
✅ POST   /api/v1/knowledge-bases
✅ GET    /api/v1/knowledge-bases
✅ POST   /api/v1/knowledge-bases/:id/documents
```

## 🚀 三种启动方式

### 方式一：当前状态 (后端已运行)

后端已经在运行，您只需启动前端：

```bash
cd frontend
npm install    # 首次运行需要
npm run dev
```

访问: http://localhost:5173

### 方式二：重新启动全部服务

停止当前后端并重启：

```bash
# 1. 如需停止后端
# 查看进程: ps aux | grep agent-platform
# 停止: killall agent-platform

# 2. 使用启动脚本
./start.sh

# 3. 启动前端
cd frontend
npm run dev
```

### 方式三：手动分步启动

```bash
# 终端1 - 后端
cd backend
go build -o agent-platform cmd/server/*.go
./agent-platform

# 终端2 - 前端
cd frontend
npm install
npm run dev
```

## 🧪 测试 API

### 快速测试脚本

```bash
./test-api.sh
```

### 手动测试

```bash
# 健康检查
curl http://localhost:8080/health

# 获取 Agent 列表
curl http://localhost:8080/api/v1/agents

# 创建 Agent
curl -X POST http://localhost:8080/api/v1/agents \
  -H 'Content-Type: application/json' \
  -d '{
    "name": "我的第一个 Agent",
    "description": "测试 Agent",
    "type": "single",
    "prompt_template": "You are a helpful assistant."
  }'

# 创建对话
curl -X POST http://localhost:8080/api/v1/conversations \
  -H 'Content-Type: application/json' \
  -d '{
    "agent_id": "agent-001",
    "title": "测试对话"
  }'

# 发送消息
curl -X POST http://localhost:8080/api/v1/conversations/conv-001/messages \
  -H 'Content-Type: application/json' \
  -d '{
    "content": "你好，我需要帮助"
  }'
```

## 📁 项目结构速览

```
agent-opus/
├── backend/              # Go 后端 (已编译运行)
│   ├── agent-platform   # 可执行文件 (正在运行)
│   ├── cmd/server/      # 源代码
│   ├── internal/        # 业务逻辑
│   └── .env            # 配置文件
│
├── frontend/            # React 前端
│   ├── src/            # 源代码
│   ├── package.json    # 依赖
│   └── vite.config.ts  # Vite 配置
│
├── start.sh            # 启动脚本
├── test-api.sh         # API 测试
├── README.md           # 完整文档
├── QUICKSTART.md       # 快速开始
└── PROJECT_STATUS.md   # 项目状态
```

## 🌐 访问地址

| 服务 | 地址 | 状态 |
|------|------|------|
| 后端 API | http://localhost:8080 | ✅ 运行中 |
| 健康检查 | http://localhost:8080/health | ✅ 可用 |
| API 文档 | http://localhost:8080/api/v1 | ✅ 可用 |
| 前端应用 | http://localhost:5173 | ⏳ 需启动 |

## 📋 核心功能演示

### 1. Dashboard
访问前端后，首页显示系统概览：
- Agent 总数
- 对话数量
- 工具数量
- 知识库统计

### 2. Agent 管理
- **创建 Agent**: 点击"创建 Agent"按钮
  - 填写名称、描述
  - 选择类型 (单Agent/多Agent)
  - 配置提示词模板
  - 保存为草稿或发布

- **查看列表**: 显示所有 Agent
  - 筛选状态 (草稿/已发布/已归档)
  - 搜索功能
  - 快速编辑和删除

- **Agent 详情**: 点击某个 Agent
  - 查看完整配置
  - 编辑设置
  - 查看使用统计

### 3. 对话管理
- **创建对话**: 选择 Agent 创建新对话
- **发送消息**: 在对话界面发送消息
- **查看历史**: 浏览所有对话记录

### 4. 工具库
- 查看内置工具
- 了解工具功能和用途

### 5. 知识库
- 查看知识库列表
- 查看文档统计

## 🔧 常用命令

### 后端相关

```bash
# 查看后端进程
ps aux | grep agent-platform

# 停止后端
killall agent-platform

# 查看后端日志
# (当前输出到终端)

# 重新编译
cd backend
go build -o agent-platform cmd/server/*.go
```

### 前端相关

```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产版本
npm run preview
```

### API 测试

```bash
# 测试所有 API
./test-api.sh

# 测试健康检查
curl http://localhost:8080/health

# 查看 API 响应（格式化）
curl -s http://localhost:8080/api/v1/agents | python3 -m json.tool
```

## 📚 进阶使用

### 连接数据库

当前使用 Mock 数据。要连接真实数据库：

1. 启动数据库服务
```bash
docker-compose up -d mysql mongodb redis
```

2. 更新 `backend/.env` 配置
```env
MYSQL_HOST=localhost
MYSQL_PORT=3307  # Docker 映射端口
MONGODB_URI=mongodb://root:rootpassword@localhost:27017
REDIS_HOST=localhost
```

3. 重启后端服务

### 接入 AI 模型

1. 配置 API Key:
```env
OPENAI_API_KEY=sk-your-key
```

2. 实现真实的 AI 调用逻辑 (待开发)

### 开发新功能

1. 后端添加 API:
   - 在 `internal/handler` 添加处理器
   - 在 `cmd/server/router.go` 注册路由

2. 前端添加页面:
   - 在 `src/pages` 创建组件
   - 在 `App.tsx` 添加路由
   - 在 `src/services` 添加 API 调用

## ❓ 常见问题

### Q: 前端无法连接后端？

**检查**:
1. 后端是否在运行: `curl http://localhost:8080/health`
2. 端口是否正确: 后端应在 8080
3. CORS 配置是否正确

### Q: 如何查看后端日志？

当前日志输出到运行后端的终端。要保存日志：
```bash
./agent-platform > logs/app.log 2>&1 &
```

### Q: 如何部署到生产环境？

查看 `docs/deployment.md` 获取详细部署指南。

### Q: API 返回 401 错误？

当前认证中间件允许无 Token 访问（demo 模式）。生产环境需配置真实的 JWT Token。

## 🎯 下一步建议

1. **立即体验**
   - 启动前端界面
   - 创建第一个 Agent
   - 测试对话功能

2. **开发功能**
   - 连接真实数据库
   - 接入 AI 模型
   - 实现知识库向量化

3. **生产部署**
   - 配置环境变量
   - 使用 Docker Compose
   - 设置反向代理

## 📖 相关文档

- [README.md](./README.md) - 完整项目说明
- [QUICKSTART.md](./QUICKSTART.md) - 快速启动指南
- [PROJECT_STATUS.md](./PROJECT_STATUS.md) - 项目状态
- [docs/deployment.md](./docs/deployment.md) - 部署文档
- [agent-platform-requirements.md](./agent-platform-requirements.md) - 需求文档

---

## 🚀 现在就开始！

```bash
# 后端已运行 ✅

# 启动前端
cd frontend
npm install
npm run dev

# 访问 http://localhost:5173
```

享受您的 Agent 平台！🎉
